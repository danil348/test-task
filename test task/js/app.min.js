window.onload = function () {
	header_scroll()
	scroll_animations()
	icon_menu()
	smoothscroll()
}

/*
	добавляет шапке сайта технический класс _scroll, когда
	страница прокручена и убирает этот класс, когда страница 
	полностью прокручена вверх
	для работы с этим скриптом необходимо:
		1) подключить этот файл
		2) вызвать функцию в script.js
*/

function header_scroll() {
	const header = document.querySelector('header')

	const callback = function (entries, observer) {
		if (entries[0].isIntersecting) {
			header.classList.remove('_scroll')
		} else {
			header.classList.add('_scroll')
		}
	}
	const headerObs = new IntersectionObserver(callback)
	headerObs.observe(header)
}

/*
	добавляет класс _show всем элементам с техническим классом animation-on-scroll
	добавление класса происходит при попадании элемента в зону видимости
	для работы с этим скриптом необходимо:
		1) подключить этот файл
		2) вызвать функцию в script.js
*/

function scroll_animations() {
	const observer  = new IntersectionObserver((entries) => {
		entries.forEach((entry) => {
			if(entry.isIntersecting){
				entry.target.classList.add('_show')
			}
		})
	})

	const elements = document.querySelectorAll('.animation-on-scroll')
	elements.forEach((element) => observer.observe(element))
}
/*
	отвечает за добавление технических классов бургер меню 
	и блоку с элементами меню.
	для работы с этим скриптом необходимо:
		1) подключить файл со скриптом
		2) вызвать функцию в script.js
		3) подключить файл __fixed-header.html
*/

function icon_menu() {
	let iconMenu = document.querySelector('.icon-menu')
	let menuBodyArray = document.querySelectorAll('.menu__body ul li')
	if (iconMenu != null) {
		let logo = document.querySelector('.header__logo')
		let menuBody = document.querySelector('.menu__body')
		iconMenu.addEventListener('click', function (e) {
			iconMenu.classList.toggle('_active')
			menuBody.classList.toggle('_active')
		})
		window.addEventListener("scroll", () => {
			iconMenu.classList.remove('_active')
			menuBody.classList.remove('_active')
		})
		menuBodyArray.forEach(element => {
			element.addEventListener('click', function (e) {
				iconMenu.classList.remove('_active')
				menuBody.classList.remove('_active')
			})
		})
		logo.addEventListener('click', function (e) {
			iconMenu.classList.remove('_active')
			menuBody.classList.remove('_active')
		})
	}
}

/*
	делает скролл на сайте плавным
	для работы с этим скриптом необходимо:
		1) подключить скрипт, который находится ниже в js.html
			<script src="https://cdnjs.cloudflare.com/ajax/libs/smoothscroll/1.4.10/SmoothScroll.min.js" integrity="sha256-huW7yWl7tNfP7lGk46XE+Sp0nCotjzYodhVKlwaNeco=" crossorigin="anonymous"></script>
		2) подключить файл с этим скриптом
		3) вызвать функцию в script.js
*/
function smoothscroll() {
	SmoothScroll({
		// Время скролла 400 = 0.4 секунды
		animationTime : 800,
		// Размер шага в пикселях
		stepSize : 75,
		
		// Дополнительные настройки:
		
		// Ускорение
		accelerationDelta : 30,
		// Максимальное ускорение
		accelerationMax : 2,
		
		// Поддержка клавиатуры
		keyboardSupport : true,
		// Шаг скролла стрелками на клавиатуре в пикселях
		arrowScroll : 50,
		
		// Pulse (less tweakable)
		// ratio of "tail" to "acceleration"
		pulseAlgorithm : true,
		pulseScale : 4,
		pulseNormalize : 1,
		
		// Поддержка тачпада
		touchpadSupport : true,
		})
}